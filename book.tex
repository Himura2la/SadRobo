%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SadRobo Comicbook
% Version 0.1 (08/05/16)
%
% This template has been downloaded from:
% https://github.com/Himura2la/SadRobo
%
% Original author:
% SadBobo Team
%
% License:
% SadRobo License (А если серьёзно, какая у нас лицензия?)
% 			     (Кто разбирается в лицензиях? Я~--- нет.)
%           (И кажется у гитхаба есть ограничения с этим.)
%
% Важные замечания:
% Роботу всё ещё грустно.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[17pt]{memoir} % 14, 17, 20
\input{config.tex} % Загружаем файл с настройками


% ------- Костыль для кириллицы в input -------

\makeatletter  
    \let\old@input\input
    \renewcommand\input[1]{
        \expandafter\old@input{"\detokenize{#1}"}
    }
\makeatother


% ------- Считаем оптимальную ширину картинки  -------
% ------- По какой-то причине Gin@nat@width возвращает размер не пикселах

\makeatletter 
\def \maxwidth{
	\ifdim\Gin@nat@width>\linewidth
		\linewidth
	\else
		\Gin@nat@width
	\fi}
\makeatother

% ------- Служебные переменные для длины и ширины картинки ------- 
\newlength\imageheight
\newlength\imagewidth

% ------- Робо-макросы ------- 

\newcommand\R{\par\noindent---~}  % Маркер робота
\newcommand\X{\par\noindent---~}  % Маркер собеседника

\newenvironment{dialog} % Пространство диалога
{  } % Выполняется в начале
{  } % Выполняется в конце

\newenvironment{monolog} % Пространство размышлений
{ \begin{quote}\itshape } % Выполняется в начале
{ \end{quote} } % Выполняется в конце

\newcommand{\newdialog}[3]{
	\chapter{Робот, которому грустно, и #2}
		\input{#2}
		\begin{figure}[p!]
			\centering
			\fbox{
			\includegraphics[height = 181.5mm, width = 159.5mm, keepaspectratio]{#2}    %Прописал числами, а то что-расходятся все параметры
			}
			\settoheight\imageheight{\includegraphics{#2}}
			\settowidth\imagewidth{\includegraphics{#2}}
			\ifthenelse{\imagewidth > \imageheight}{\center #3}{}
		\end{figure}
	\setcounter{dianum}{#1}
}



\begin{document} % --------------------------------

\newdialog{002}{Викинги}{Борода лучше своего отсутствия}
\newdialog{004}{Создатель}{Все мы что-то создаём}
\newdialog{014}{Паук}{Тащемта, например}
\newdialog{018}{Ницше}{Сверхчеловек не нашего времени}
\newdialog{029}{Все}{Это можно было бы назвать вечеринкой, если Вечер бы пришёл. Но пришёл только Все}
\newdialog{035}{Студенты}{Фанатичные адепты богини Халявы}
\newdialog{036}{Митинг}{Листовки, шарики и атрибутика в подарок!}
\newdialog{040}{Мой здравый смысл}{Вернись ко мне, когда нступит вчера}
\newdialog{061}{Утренняя газета}{Все-равно её никто не читает}
\newdialog{071}{Лао Цзы}{Восточная философия - сложна и опасна}
\newdialog{072}{Время}{Его всегда слишком много, но никогда не хватает}
\newdialog{074}{Даос-какаос}{Ох это прекрасное, освежающее и бодрящее столкновение с посохом}
\newdialog{088}{Мотивация}{Тут что-то нужно ещё добавить?}
\newdialog{089}{Политика}{Нельзя коснуться, не испачкавшись}
\newdialog{090}{Маркетинг}{Без него не было бы этой книги}
\newdialog{095}{Боян}{Где-то я всё это уже видел}
\newdialog{108}{Калечные девы}{Датфил}
\newdialog{109}{Лекция}{Я там был, инфа 100\%}
\newdialog{134}{Шайа Лабаф}{Джазовый дуэт}
\newdialog{137}{Шон Бин}{Казалось бы, причём здесь Караваждо?}
\newdialog{140}{Аниме}{Примерно так я и стал хиккой}
\newdialog{148}{Председатель земного шара}{Когда умирают травы — сохнут}

\end{document}